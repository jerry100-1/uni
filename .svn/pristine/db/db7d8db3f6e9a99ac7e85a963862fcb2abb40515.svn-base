(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/pro/proAdd"],{"1fcd":function(e,t,o){"use strict";var i=o("a844"),n=o.n(i);n.a},"355a":function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o("939c");var i=function(){return o.e("components/uni-icon/uni-icon").then(o.bind(null,"0ac5"))},n={components:{uniIcon:i},data:function(){return{isreq:!1,shopObj:{},initNum:[0,0,0],cateId2:"",cateId3:"",brandId:"",produceCity:"",produceProvince:"",proId:"",shopName:"",shopIntr:"",shopPrice:"",price:"",skoce:"",proWeight:0,expressConfig:1,keyWord:"",proImgs:[],shopDetails:"",proDetailsImg:[],shopBrand:[{brandname:""}],shopBrandIndex:0,shopClassify:["联盟商家"],shopIndex:0,twoCate:[{catename:""}],twoIndex:0,productRatio:0,threeCate:[{catename:""}],threeIndex:0,provinceList:[{proName:""}],provinceIndex:0,cityList:[{proName:""}],cityIndex:0}},methods:{limit:function(e){var t="";t=(e/1048576).toFixed(2);var o=t+"",i=o.indexOf("."),n=o.substr(i+1,2);return"00"==n?o.substring(0,i)+o.substr(i+3,2):t},provinceListChange:function(e){this.provinceIndex=e.detail.value,this.citySearch()},cityListChange:function(e){this.cityIndex=e.detail.value},proRatio:function(e){this.productRatio=e},citySearch:function(){var e=this;e.$ajax({url:"/shopProduct/getCommonAddressCityList",method:"POST",data:{proCode:e.provinceList[e.provinceIndex].code},success:function(t){if(e.cityList=t,0==e.initNum[2])for(var o in e.initNum[2]=1,t)if(e.produceCity==t[o].code){e.cityIndex=o;break}}})},getBytesLength:function(e){for(var t=e.length,o=0;o<e.length;o++)e.charCodeAt(o)>255&&t++;return t},proImgsChoose:function(t){var o=this;1==t&&o.proImgs.length>4?e.showToast({title:"商品图片最多上传五张",icon:"none"}):e.chooseImage({count:1,sizeType:["original","compressed"],success:function(i){o.limit(i.tempFiles[0].size)>3?e.showToast({title:"图片太大",icon:"none"}):o.$ajax({uploadFile:!0,formData:{fileName:"/product/"},filePath:i.tempFilePaths[0],success:function(e){1==t?o.proImgs.push(e):o.proDetailsImg.push(e)}})}})},uploadImg:function(t,o){var i=this;e.showLoading({title:"加载中"}),i.$ajax({url:"/commonUpload/upload",method:"POST",data:{file:t,fileName:"/product/"},success:function(t){console.log(t," at pages\\pro\\proAdd.vue:290"),e.hideLoading()}})},del:function(e,t){var o=this;console.log(e," at pages\\pro\\proAdd.vue:299"),1==t?o.proImgs.splice(e,1):o.proDetailsImg.splice(e,1)},expressFun:function(e){this.expressConfig=1==e.detail.value.length?1:2},shopClassifyChange:function(e){this.shopIndex=e.detail.value},selectThree:function(e){var t=this;t.$ajax({url:"/shopProduct/getByThreeCate",method:"POST",data:{cateSource:5,cid:e},success:function(e){if(t.threeCate=e,0==t.initNum[0])for(var o in t.initNum[0]=1,t.threeCate)if(t.cateId2==t.threeCate[o].cateid){t.threeIndex=o;break}}})},twoCateFun:function(e){var t=this;t.twoIndex=e.detail.value,t.selectThree(t.twoCate[t.twoIndex].cid)},threeCateFun:function(e){this.threeIndex=e.detail.value},init:function(){var e=this;e.$ajax({url:"/shopProduct/getSelectShopProductBrand",method:"POST",success:function(t){if(e.shopBrand=t,0==e.initNum[1])for(var o in e.initNum[1]=1,t)if(e.brandId==t[o].brandid){e.shopBrandIndex=o;break}}}),e.$ajax({url:"/shopProduct/getByTwoCate",method:"POST",data:{cateId:3},success:function(t){if(e.twoCate=t,0==e.initNum[0])for(var o in e.twoCate)if(e.cateId2==e.twoCate[o].cateid){e.twoIndex=o;break}e.selectThree(e.twoCate[e.twoIndex].cid)}}),e.$ajax({url:"/shopProduct/getCommonAddressProvinceList",method:"POST",success:function(t){if(e.provinceList=t,0==e.initNum[2])for(var o in t)if(e.produceProvince==t[o].code){e.provinceIndex=o;break}e.citySearch()}})},save:function(){var t=this;console.log(0," at pages\\pro\\proAdd.vue:413"),t.shopName&&t.price&&t.shopPrice&&0!=t.proImgs.length&&t.skoce&&0!=t.proDetailsImg.length?t.isreq||(t.isreq=!0,t.$ajax({url:"/shopProduct/saveShopProduct",method:"POST",data:{brandId:t.shopBrand[t.shopBrandIndex].brandid,cateId1:3,cateId2:t.twoCate[t.twoIndex].cateid,cateId3:t.threeCate[t.threeIndex].cateid,expressConfig:t.expressConfig,keyWord:t.keyWord,originalImg:t.proImgs,produceCity:t.cityList[t.cityIndex].code,produceProvince:t.provinceList[t.provinceIndex].code,productDescribeImg:t.proDetailsImg,productId:t.proId||"",productName:t.shopName||"",productRatio:0==t.productRatio?8:15,productTitle:t.shopIntr,productmMinMoney:1*t.price,shopId:t.shopObj.shopId,sumStock:1*t.skoce,weight:t.proWeight,agoraMoney:t.shopPrice},success:function(o){t.isreq=!1,e.showToast({title:"操作成功",icon:"none"}),setTimeout(function(){e.navigateBack({delta:1})},1500)},error:function(){t.isreq=!1}})):e.showToast({title:"请填写完整的信息",icon:"none"})}},onLoad:function(t){var o=this;e.getStorage({key:"shopObj",success:function(e){o.shopObj=JSON.parse(e.data)}}),t.proId?(this.proId=t.proId,e.setNavigationBarTitle({title:"商品编辑"}),this.$ajax({url:"/shopProduct/getUpdateProduct",method:"POST",data:{productId:o.proId},success:function(e){console.log(e," at pages\\pro\\proAdd.vue:488"),o.proImgs=e.originalImg,o.shopName=e.productName||"",o.skoce=e.sumStock||"",o.shopIntr=e.productTitle||"",o.keyWord=e.keyWord||"",o.price=e.productmMinMoney||"",o.productRatio=15==e.productRatio?1:0,o.expressConfig=e.expressConfig,o.proWeight=e.weight,o.cateId2=e.cateId2,o.cateId3=e.cateId3,o.brandId=e.brandId,o.shopPrice=e.agoraMoney||"",o.produceCity=e.produceCity,o.produceProvince=e.produceProvince;var t=/<img.*?(?:>|\/>)/gi,i=/src=[\'\"]?([^\'\"]*)[\'\"]?/i,n=[];e.productDescribe&&(n=e.productDescribe.match(t)),console.log(n," at pages\\pro\\proAdd.vue:510"),o.$ajax({url:"/shopProduct/getByTwoCate",method:"POST",data:{cateId:3},success:function(e){if(o.twoCate=e,0==o.initNum[0])for(var t in o.twoCate)if(o.cateId2==o.twoCate[t].cateid){o.twoIndex=t;break}o.selectThree(o.twoCate[o.twoIndex].cid)}});for(var r=0;r<n.length;r++){var a=n[r].match(i);console.log(a,"111"," at pages\\pro\\proAdd.vue:532"),o.proDetailsImg.push(a[1])}o.init()}})):(o.initNum=[1,1,1],o.init())}};t.default=n}).call(this,o("6e42")["default"])},"3e7d":function(e,t,o){"use strict";o.r(t);var i=o("355a"),n=o.n(i);for(var r in i)"default"!==r&&function(e){o.d(t,e,function(){return i[e]})}(r);t["default"]=n.a},"5dd3":function(e,t,o){"use strict";o.r(t);var i=o("ce05"),n=o("3e7d");for(var r in n)"default"!==r&&function(e){o.d(t,e,function(){return n[e]})}(r);o("1fcd");var a=o("2877"),c=Object(a["a"])(n["default"],i["a"],i["b"],!1,null,"6111efd5",null);t["default"]=c.exports},a844:function(e,t,o){},ce05:function(e,t,o){"use strict";var i=function(){var e=this,t=e.$createElement;e._self._c},n=[];o.d(t,"a",function(){return i}),o.d(t,"b",function(){return n})}},[["8627","common/runtime","common/vendor"]]]);